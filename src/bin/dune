(rule
 (alias base)
 (deps liquidsoap.exe build_config.exe)
 (action (echo "Liquidsoap built!\n")))

(executable
 (name liquidsoap)
 (public_name liquidsoap)
 (package liquidsoap)
 (link_flags -cclib %{env:LDFLAGS=})
 (libraries
  liquidsoap_core
  liquidsoap_optionals
  liquidsoap_builtins
  (select
   runner.ml
   from
   (winsvc -> runner.winsvc.ml)
   (-> runner.default.ml)))
 (modules liquidsoap runner main))

(executable
 (name build_config)
 (modules build_config)
 (link_flags -cclib %{env:LDFLAGS=})
 (preprocess
  (pps ppx_string))
 (libraries liquidsoap_core liquidsoap_optionals))

(executable
 (name sys_config)
 (modules sys_config)
 (link_flags -cclib %{env:LDFLAGS=})
 (libraries dune-configurator))
