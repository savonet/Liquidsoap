<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Producer_consumer (liquidsoap_core@8e9bf4542caf.Producer_consumer)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.4"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">liquidsoap_core@8e9bf4542caf</a> &#x00BB; Producer_consumer</nav><header class="odoc-preamble"><h1>Module <code><span>Producer_consumer</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type anchored" id="type-write_payload"><a href="#type-write_payload" class="anchor"></a><code><span><span class="keyword">type</span> write_payload</span><span> = </span><span>[ </span></code><ol><li id="type-write_payload.Frame" class="def variant constructor anchored"><a href="#type-write_payload.Frame" class="anchor"></a><code><span>| </span><span>`Frame <span class="keyword">of</span> <a href="../Frame/index.html#type-t">Frame.t</a></span></code></li><li id="type-write_payload.Flush" class="def variant constructor anchored"><a href="#type-write_payload.Flush" class="anchor"></a><code><span>| </span><span>`Flush</span></code></li></ol><code><span> ]</span></code></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-write_frame"><a href="#type-write_frame" class="anchor"></a><code><span><span class="keyword">type</span> write_frame</span><span> = <span><a href="#type-write_payload">write_payload</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec class anchored" id="class-consumer"><a href="#class-consumer" class="anchor"></a><code><span><span class="keyword">class</span> </span><span><a href="class-consumer/index.html">consumer</a></span><span> : <span><span class="optlabel">?always_enabled</span>:<span>bool option</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">write_frame</span>:<span>(<span><a href="../Generator/index.html#type-t">Generator.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[&gt; `Flush <span><span>| `Frame</span> of <a href="../Frame/index.html#type-t">Frame.t</a></span> ]</span> <span class="arrow">&#45;&gt;</span></span>
  unit)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">name</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span class="label">source</span>:<a href="../Lang/index.html#type-value">Lang.value</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="keyword">object</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec class anchored" id="class-producer"><a href="#class-producer" class="anchor"></a><code><span><span class="keyword">class</span> </span><span><a href="class-producer/index.html">producer</a></span><span> : <span><span class="optlabel">?stack</span>:<span><span><a href="../Pos/index.html#type-t">Pos.t</a> list</span> option</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">check_self_sync</span>:bool <span class="arrow">&#45;&gt;</span></span> <span><span class="label">consumers</span>:<span><span>&lt; abort_track : 
                                                                   unit
                                                                   ; 
                                                                   active : 
                                                                   bool
                                                                   ; 
                                                                   add_watcher : 
                                                                   <span><a href="../Source/index.html#type-watcher">Source.watcher</a> <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   buffer : 
                                                                   <a href="../Generator/index.html#type-t">Generator.t</a>
                                                                   ; 
                                                                   clock : 
                                                                   <a href="../Clock/index.html#type-t">Clock.t</a>
                                                                   ; 
                                                                   consumed : 
                                                                   <span>int <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   content_type : 
                                                                   <a href="../Frame/index.html#type-content_type">Frame.content_type</a>
                                                                   ; 
                                                                   content_type_computation_allowed : 
                                                                   unit
                                                                   ; 
                                                                   duration : 
                                                                   int
                                                                   ; 
                                                                   elapsed : 
                                                                   int
                                                                   ; 
                                                                   empty_frame : 
                                                                   <a href="../Frame/index.html#type-t">Frame.t</a>
                                                                   ; 
                                                                   end_of_track : 
                                                                   <a href="../Frame/index.html#type-t">Frame.t</a>
                                                                   ; 
                                                                   fallible : 
                                                                   bool
                                                                   ; 
                                                                   force_sleep : 
                                                                   unit
                                                                   ; 
                                                                   frame_audio_position : 
                                                                   int
                                                                   ; 
                                                                   frame_has_track_mark : 
                                                                   bool
                                                                   ; 
                                                                   frame_metadata : 
                                                                   <span><span>(int
                                                                    * 
                                                                    <a href="../Frame/Metadata/index.html#type-t">Frame.Metadata.t</a>)</span>
                                                                    list</span>
                                                                   ; 
                                                                   frame_position : 
                                                                   int
                                                                   ; 
                                                                   frame_track_mark : 
                                                                   <span>int option</span>
                                                                   ; 
                                                                   frame_type : 
                                                                   <a href="../Type/index.html#type-t">Type.t</a>
                                                                   ; 
                                                                   get_frame : 
                                                                   <a href="../Frame/index.html#type-t">Frame.t</a>
                                                                   ; 
                                                                   get_mutable_content : 
                                                                   <span><a href="../Frame/index.html#type-field">Frame.field</a> <span class="arrow">&#45;&gt;</span></span>
                                                                   <a href="../Content/index.html#type-data">Content.data</a>
                                                                   ; 
                                                                   get_mutable_frame : 
                                                                   <span><a href="../Frame/index.html#type-field">Frame.field</a> <span class="arrow">&#45;&gt;</span></span>
                                                                   <a href="../Frame/index.html#type-t">Frame.t</a>
                                                                   ; 
                                                                   get_partial_frame : 
                                                                   <span><span>(<span><a href="../Frame/index.html#type-t">Frame.t</a> <span class="arrow">&#45;&gt;</span></span>
                                                                    <a href="../Frame/index.html#type-t">Frame.t</a>)</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   <a href="../Frame/index.html#type-t">Frame.t</a>
                                                                   ; 
                                                                   has_content_type : 
                                                                   bool
                                                                   ; 
                                                                   id : 
                                                                   string
                                                                   ; 
                                                                   is_ready : 
                                                                   bool
                                                                   ; 
                                                                   is_up : 
                                                                   bool
                                                                   ; 
                                                                   last_image : 
                                                                   <span><a href="../Frame/Fields/index.html#type-field">Frame.Fields.field</a> <span class="arrow">&#45;&gt;</span></span>
                                                                   <span class="xref-unresolved">Mm</span>.Video.Canvas.image
                                                                   ; 
                                                                   last_metadata : 
                                                                   <span><a href="../Frame/index.html#type-metadata">Frame.metadata</a>
                                                                    option</span>
                                                                   ; 
                                                                   log : 
                                                                   <span>&lt; 
                                                                   active : 
                                                                   <span>int <span class="arrow">&#45;&gt;</span></span>
                                                                   bool
                                                                   ; 
                                                                   critical : 
                                                                   'a. <span>
                                                                   <span><span>(<span class="type-var">'a</span>,
                                                                    unit,
                                                                    string,
                                                                    unit)</span>
                                                                    <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   <span class="type-var">'a</span>
                                                                   ; 
                                                                   debug : 
                                                                   'a. <span>
                                                                   <span><span>(<span class="type-var">'a</span>,
                                                                    unit,
                                                                    string,
                                                                    unit)</span>
                                                                    <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   <span class="type-var">'a</span>
                                                                   ; 
                                                                   f : 
                                                                   'a. <span>
                                                                   int <span class="arrow">&#45;&gt;</span></span>
                                                                   <span><span><span>(<span class="type-var">'a</span>,
                                                                    unit,
                                                                    string,
                                                                    unit)</span>
                                                                    <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   <span class="type-var">'a</span>
                                                                   ; 
                                                                   important : 
                                                                   'a. <span>
                                                                   <span><span>(<span class="type-var">'a</span>,
                                                                    unit,
                                                                    string,
                                                                    unit)</span>
                                                                    <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   <span class="type-var">'a</span>
                                                                   ; 
                                                                   info : 
                                                                   'a. <span>
                                                                   <span><span>(<span class="type-var">'a</span>,
                                                                    unit,
                                                                    string,
                                                                    unit)</span>
                                                                    <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   <span class="type-var">'a</span>
                                                                   ; 
                                                                   level : 
                                                                   <span>int option</span>
                                                                   ; 
                                                                   set_level : 
                                                                   <span>int <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   severe : 
                                                                   'a. <span>
                                                                   <span><span>(<span class="type-var">'a</span>,
                                                                    unit,
                                                                    string,
                                                                    unit)</span>
                                                                    <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   <span class="type-var">'a</span>.. &gt;</span>
                                                                   ; 
                                                                   on_after_streaming_cycle : 
                                                                   <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span>
                                                                    unit)</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   on_before_streaming_cycle : 
                                                                   <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span>
                                                                    unit)</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   on_metadata : 
                                                                   <span><span>(<span><a href="../Frame/index.html#type-metadata">Frame.metadata</a> <span class="arrow">&#45;&gt;</span></span>
                                                                    unit)</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   on_sleep : 
                                                                   <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span>
                                                                    unit)</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   on_track : 
                                                                   <span><span>(<span><a href="../Frame/index.html#type-metadata">Frame.metadata</a> <span class="arrow">&#45;&gt;</span></span>
                                                                    unit)</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   on_wake_up : 
                                                                   <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span>
                                                                    unit)</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   peek_frame : 
                                                                   <a href="../Frame/index.html#type-t">Frame.t</a>
                                                                   ; 
                                                                   pos : 
                                                                   <a href="../../liquidsoap-lang/Liquidsoap_lang/Pos/Option/index.html#type-t">Pos.Option.t</a>
                                                                   ; 
                                                                   register_command : 
                                                                   <span><span class="optlabel">?usage</span>:
                                                                    string <span class="arrow">&#45;&gt;</span></span>
                                                                   <span><span class="label">descr</span>:string <span class="arrow">&#45;&gt;</span></span>
                                                                   <span>string <span class="arrow">&#45;&gt;</span></span>
                                                                   <span><span>(<span>string <span class="arrow">&#45;&gt;</span></span>
                                                                    string)</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   remaining : 
                                                                   int
                                                                   ; 
                                                                   reset_last_metadata_on_track : 
                                                                   bool
                                                                   ; 
                                                                   seek : 
                                                                   <span>int <span class="arrow">&#45;&gt;</span></span>
                                                                   int
                                                                   ; 
                                                                   seek_source : 
                                                                   <a href="../Source/class-source/index.html">Source.source</a>
                                                                   ; 
                                                                   self_sync : 
                                                                   <span>[&lt; 
                                                                   `Dynamic
                                                                   <span>| `Static</span> Dynamic ]</span>
                                                                   * 
                                                                   <span><a href="../Clock/index.html#type-sync_source">Clock.sync_source</a>
                                                                    option</span>
                                                                   ; 
                                                                   set_frame_data : 
                                                                   'a. <span>
                                                                   <a href="../Frame/index.html#type-field">Frame.field</a> <span class="arrow">&#45;&gt;</span></span>
                                                                   <span><span>(<span><span class="optlabel">?offset</span>:int <span class="arrow">&#45;&gt;</span></span>
                                                                    <span><span class="optlabel">?length</span>:int <span class="arrow">&#45;&gt;</span></span>
                                                                    <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
                                                                    <a href="../Content/index.html#type-data">Content.data</a>)</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   <a href="../Frame/index.html#type-t">Frame.t</a>
                                                                   ; 
                                                                   set_id : 
                                                                   <span><span class="optlabel">?definitive</span>:
                                                                    bool <span class="arrow">&#45;&gt;</span></span>
                                                                   <span>string <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   set_name : 
                                                                   <span>string <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   set_output_enabled : 
                                                                   <span>bool <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   set_producer_buffer : 
                                                                   <span><a href="../Generator/index.html#type-t">Generator.t</a> <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   set_reset_last_metadata_on_track : 
                                                                   <span>bool <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   set_stack : 
                                                                   <span><span><a href="../Pos/index.html#type-t">Pos.t</a> list</span> <span class="arrow">&#45;&gt;</span></span>
                                                                   unit
                                                                   ; 
                                                                   sleep : 
                                                                   unit
                                                                   ; 
                                                                   source_sync : 
                                                                   <span>bool <span class="arrow">&#45;&gt;</span></span>
                                                                   <span><a href="../Clock/index.html#type-sync_source">Clock.sync_source</a>
                                                                    option</span>
                                                                   ; 
                                                                   source_type : 
                                                                   <span>[&lt; 
                                                                   <a href="../Source/index.html#type-source_type">Source.source_type</a> ]</span>
                                                                   ; 
                                                                   stack : 
                                                                   <span><a href="../Pos/index.html#type-t">Pos.t</a> list</span>
                                                                   ; 
                                                                   stack_unifier : 
                                                                   <span><span><a href="../Pos/index.html#type-t">Pos.t</a> list</span>
                                                                    <a href="../Unifier/index.html#type-t">Unifier.t</a></span>
                                                                   ; 
                                                                   wake_up : 
                                                                   unit.. &gt;</span>
                                                                   list</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="label">name</span>:
  string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="keyword">object</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>The source which produces data by reading the buffer. We do NOT want to use <code>operator</code> here b/c the <code>consumers</code> may have different content-kind when this is used in the muxers.</p></div></div></div></body></html>
