# This file is generated by dune, edit dune-project instead
opam-version: "2.0"
version: "2.2.0"
synopsis: "Swiss-army knife for multimedia streaming"
description: """
Liquidsoap is a powerful and flexible language for describing your
streams. It offers a rich collection of operators that you can combine
at will, giving you more power than you need for creating or
transforming streams. But liquidsoap is still very light and easy to
use, in the Unix tradition of simple strong components working
together.
"""
maintainer: ["The Savonet Team <savonet-users@lists.sourceforge.net>"]
authors: ["The Savonet Team <savonet-users@lists.sourceforge.net>"]
license: "GPL-2.0-or-later"
homepage: "https://github.com/savonet/liquidsoap"
bug-reports: "https://github.com/savonet/liquidsoap/issues"
depends: [
  "dune" {>= "3.2"}
  "ocaml" {>= "4.14.0" & < "5.0.0"}
  "dtools" {>= "0.4.5"}
  "duppy" {>= "0.9.1"}
  "mm" {>= "0.8.3"}
  "pcre" {>= "7.5.0"}
  "ocurl" {>= "0.9.2"}
  "cry" {>= "0.6.5"}
  "camomile" {>= "2.0.0"}
  "uri"
  "fileutils"
  "menhirLib"
  "metadata" {>= "0.2.0"}
  "dune-build-info"
  "liquidsoap-lang"
  "liquidsoap-libs"
  "ppx_string" {build}
  "odoc" {with-doc}
]
depopts: [
  "alsa"
  "ao"
  "bjack"
  "camlimages"
  "ctypes-foreign"
  "dssi"
  "faad"
  "fdkaac"
  "ffmpeg"
  "flac"
  "frei0r"
  "gd"
  "graphics"
  "gstreamer"
  "imagelib"
  "inotify"
  "irc-client-unix"
  "ladspa"
  "lame"
  "lastfm"
  "lilv"
  "lo"
  "mad"
  "magic"
  "memtrace"
  "mem_usage"
  "ogg"
  "opus"
  "osc-unix"
  "osx-secure-transport"
  "portaudio"
  "posix-time2"
  "pulseaudio"
  "prometheus-liquidsoap"
  "samplerate"
  "shine"
  "soundtouch"
  "speex"
  "srt"
  "ssl"
  "taglib"
  "theora"
  "tsdl"
  "tsdl-image"
  "tsdl-ttf"
  "vorbis"
  "yaml"
  "xmlplaylist"
]
conflicts: [
  "alsa" {< "0.3.0"}
  "ao" {< "0.2.0"}
  "bjack" {< "0.1.3"}
  "camomile" {< "1.0.0"}
  "dssi" {< "0.1.3"}
  "faad" {< "0.5.0"}
  "fdkaac" {< "0.3.1"}
  "ffmpeg" {< "1.1.8"}
  "ffmpeg-avutil" {< "1.1.8"}
  "flac" {< "0.3.0"}
  "frei0r" {< "0.1.0"}
  "gstreamer" {< "0.3.1"}
  "inotify" {< "1.0"}
  "ladspa" {< "0.2.0"}
  "lame" {< "0.3.5"}
  "lastfm" {< "0.3.0"}
  "lo" {< "0.2.0"}
  "liquidsoap" {< "2.2.0"}
  "mad" {< "0.5.0"}
  "magic" {< "0.6"}
  "mem_usage" {< "0.0.3"}
  "ogg" {< "0.7.0"}
  "opus" {< "0.2.0"}
  "portaudio" {< "0.2.0"}
  "posix-time2" {< "2.0.2"}
  "pulseaudio" {< "0.1.4"}
  "samplerate" {< "0.1.5"}
  "shine" {< "0.2.0"}
  "soundtouch" {< "0.1.9"}
  "speex" {< "0.4.0"}
  "srt" {< "0.3.0"}
  "ssl" {< "0.5.2"}
  "taglib" {< "0.3.10"}
  "sdl-liquidsoap" {< "2"}
  "tsdl-image" {< "0.3.2"}
  "theora" {< "0.4.0"}
  "vorbis" {< "0.8.0"}
  "xmlplaylist" {< "0.1.3"}
]
build: [
  ["dune" "subst"] {dev}
  [
    "dune"
    "build"
    "-p"
    name
    "-j"
    jobs
    "--promote-install-files=false"
    "@install"
    "@runtest" {with-test}
    "@doc" {with-doc}
  ]
  ["dune" "install" "-p" name "--create-install-files" name]
]
post-messages: [
  """\
We're sorry that your liquidsoap install failed. Check out our installation
instructions at: https://www.liquidsoap.info/doc-%{version}%/install.html#opam
for more information."""
    {failure}
  "✨ Congratulations on installing liquidsoap! ✨" {success}
  """\
We noticed that you did not install any mp3 decoder. This is a feature most
users want. You might need to install the mad or ffmpeg package."""
    {success & !mad-enabled & !ffmpeg-enabled}
  """\
We noticed that you did not install any mp3 encoder. This is a feature most
users want. You might need to install the lame or shine package."""
    {success & !lame-enabled & !shine-enabled & !ffmpeg-enabled}
  """\
We noticed that you did not install the samplerate package. We strongly
recommend this package for audio samplerate conversion."""
    {success & !samperate-enabled}
  """\
We noticed that you did not install the taglib package that provides support
to decode metadata tags from many audio and video media files. This is a feature
most users want."""
    {success & !taglib-enabled}
  """\
We noticed that you did not install any ssl support package. Liquidsoap won't
be able to use any of the `https.{get,...}` operators. You might want to install one of ssl or
osx-secure-transport package."""
    {success & !ssl-enabled & !secure-transport-enabled}
  """\
We noticed that your build includes GStreamer support. This support is DEPRECATED.
We suggest you consider moving to FFmpeg, which should provide same the same level
of functionalities."""
    {success & gstreamer-enabled}
]
depexts: ["coreutils"] {os = "macos" & os-distribution = "homebrew"}
dev-repo: "git+https://github.com/savonet/liquidsoap.git"
